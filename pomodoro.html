<script>
  let isRunning = false;
  let isFocus = true;
  let timer;
  let remainingSeconds = 1500; // Standardwert

  const timerDisplay = document.getElementById("timer");
  const phaseDisplay = document.getElementById("phase");

  function getTimes() {
    const focusMinutes = parseInt(document.getElementById("focusTime").value) || 25;
    const breakMinutes = parseInt(document.getElementById("breakTime").value) || 5;
    return {
      focus: focusMinutes * 60,
      break: breakMinutes * 60
    };
  }

  function updateDisplay() {
    const minutes = Math.floor(remainingSeconds / 60).toString().padStart(2, "0");
    const seconds = (remainingSeconds % 60).toString().padStart(2, "0");
    timerDisplay.textContent = `${minutes}:${seconds}`;
    phaseDisplay.textContent = isFocus ? "Fokuszeit" : "Pause";
  }

  function startTimer() {
    if (isRunning) return;
    isRunning = true;

    if (remainingSeconds <= 0) {
      const times = getTimes();
      remainingSeconds = isFocus ? times.focus : times.break;
    }

    timer = setInterval(() => {
      if (remainingSeconds > 0) {
        remainingSeconds--;
        updateDisplay();
      } else {
        clearInterval(timer);
        isRunning = false;
        isFocus = !isFocus;

        const times = getTimes();
        remainingSeconds = isFocus ? times.focus : times.break;
        updateDisplay();
        startTimer(); // automatisch weiter
      }
    }, 1000);
  }

  function pauseTimer() {
    clearInterval(timer);
    isRunning = false;
  }

  function resetTimer() {
    clearInterval(timer);
    isRunning = false;
    const times = getTimes();
    remainingSeconds = isFocus ? times.focus : times.break;
    updateDisplay();
  }

  // Initialanzeige mit Startwert
  const initial = getTimes();
  remainingSeconds = initial.focus;
  updateDisplay();
</script>
